<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SusheelCoder App</title>
  <meta name="theme-color" content="#0d47a1">
  <link rel="manifest" href="manifest.json">

  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 50px;
      background: linear-gradient(135deg, #e3f2fd, #bbdefb);
      height: 100vh;
      margin: 0;
    }

    h1 {
      color: #0d47a1;
      font-size: 2em;
      margin-bottom: 10px;
    }

    p {
      color: #333;
      font-size: 1.1em;
      margin-bottom: 30px;
    }

    #installBtn {
      display: none;
      background: #0d47a1;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: 0.3s;
    }

    #installBtn:hover {
      background: #1565c0;
    }
  </style>
</head>
<body>

  <h1>Welcome to SusheelCoder ðŸš€</h1>
  <p>Click the button below to install this app on your device.</p>

  <button id="installBtn">ðŸ“± Add to Home Screen</button>

  <script>
    const manifestData = {
      "name": "SusheelCoder App",
      "short_name": "SusheelCoder",
      "start_url": "./index.html",
      "display": "standalone",
      "background_color": "#ffffff",
      "theme_color": "#0d47a1",
      "icons": [
        {
          "src": "https://cdn-icons-png.flaticon.com/512/888/888879.png",
          "sizes": "192x192",
          "type": "image/png"
        },
        {
          "src": "https://cdn-icons-png.flaticon.com/512/888/888879.png",
          "sizes": "512x512",
          "type": "image/png"
        }
      ]
    };

    const stringManifest = JSON.stringify(manifestData);
    const blob = new Blob([stringManifest], { type: 'application/json' });
    const manifestURL = URL.createObjectURL(blob);
    document.querySelector('link[rel="manifest"]').setAttribute('href', manifestURL);

    // Register service worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js', { scope: './' })
        .then(() => console.log('Service Worker Registered'))
        .catch(err => console.log('Service Worker registration failed:', err));
    }

    // Add to Home Screen logic
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      installBtn.style.display = 'inline-block';
    });

    installBtn.addEventListener('click', async () => {
      installBtn.style.display = 'none';
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log(`User response: ${outcome}`);
        deferredPrompt = null;
      }
    });

    // Create simple Service Worker inline (if not exists)
    if ('serviceWorker' in navigator) {
      const swCode = `
        self.addEventListener('install', (event) => {
          console.log('Service Worker installing.');
          self.skipWaiting();
        });
        self.addEventListener('activate', (event) => {
          console.log('Service Worker activating.');
        });
        self.addEventListener('fetch', (event) => {
          event.respondWith(fetch(event.request));
        });
      `;
      const blob = new Blob([swCode], { type: 'application/javascript' });
      const swURL = URL.createObjectURL(blob);
      navigator.serviceWorker.register(swURL);
    }
  </script>
</body>
</html>
